<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.project.movieadmin.story">
	<insert id="S_INSERT" parameterType="com.project.movieadmin.story.StoryVO">
		INSERT INTO story (nickname, content, save_img, save_video, good, report, duration)
		VALUES (#{nickname}, #{content}, #{save_img}, #{save_video}, 0, 0, #{duration});
	</insert>

	<update id="S_UPDATE">
		UPDATE story
    	SET content = #{content}
    	WHERE story_num = #{story_num};
	</update>

	<delete id="S_DELETE">
		DELETE FROM story
    	WHERE story_num = #{story_num};
	</delete>
	
	<select id="S_SELECT_ONE" resultType="com.project.movieadmin.story.StoryVO">
		SELECT * <!-- story_num, nickname, content -->
		FROM story
		where story_num=#{story_num}
	</select>

	<select id="S_SELECT_RANDOMLIST" resultType="com.project.movieadmin.story.StoryVO">
		SELECT * <!-- story_num, nickname, content -->
		FROM story
		where story_num=#{story_num}
		<!-- 
		SELECT * story_num, nickname, content
		FROM story
		ORDER BY RAND(); LIMIT 1 (웨어절을 넣어서 )
		 -->
	</select>

	<select id="S_SELECT_ALL" resultType="com.project.movieadmin.story.StoryVO">
		SELECT * FROM story ORDER BY story_num DESC

	</select>

	<select id="S_SELECT_ALL_PAGE_BLOCK" resultType="com.project.movieadmin.story.StoryVO">
		<!-- SELECT * FROM story -->
	    SELECT * FROM story ORDER BY story_num DESC LIMIT 0, 5
	</select>
	<select id="S_SELECT_ALL_PAGE_BLOCK_NICKNAME" resultType="com.project.movieadmin.story.StoryVO">
		<!-- SELECT * FROM story -->
	    SELECT * FROM story where nickname=#{vo.nickname}  ORDER BY story_num DESC LIMIT #{startRow},#{pageBlock}
	</select>
	
	<select id="S_GETLIVESTORIES" resultType="com.project.movieadmin.story.StoryVO">
		 SELECT *
		 FROM story
		 WHERE expire_date > CURDATE()
	</select>
	
	<select id="S_TOTAL_ROWS" resultType="int">
		 SELECT COUNT(*) total_rows FROM story 
	</select>
	
	<select id="S_REMOVEEXPIRED" resultType="com.project.movieadmin.story.StoryVO">
		
	</select>
	
	<update id="S_INCREASEGOOD">
		UPDATE story
		SET good=good+1
		WHERE story_num=#{story_num} 				
	</update>
	
	<select id="S_SELECT_GOOD" resultType="int">
		SELECT count(*) count
		FROM goodcheck
		WHERE story_num=#{story_num} and nickname=#{nickname}
	</select>
	
	<insert id="S_INSERT_GOOD">
		insert into goodcheck(story_num,nickname) values(#{story_num},#{nickname});
	</insert>
	
	<select id="S_GOOD_CHECK" resultType="int">
		SELECT COUNT(*) AS like_count
		FROM goodcheck
		WHERE nickname = #{nickname} AND story_num = #{story_num}
		
	</select>
	
	<select id="S_GOOD_SAVE" resultType="int">
		INSERT INTO goodcheck(nickname, story_num, story_num)
		VALUES(#{nickname},#{story_num},#{story_num})
	</select>
	
	<select id="S_CHECK_USER_GOOD_COUNT" resultType="int">
		SELECT COUNT(*) count
		FROM goodcheck
		WHERE  story_num = #{story_num}
	</select>
	
	<select id="S_UPDATE_REPORT_COUNT" resultType="com.project.movieadmin.story.StoryVO">
		
	</select>

	
	<select id="SEARCHLIST_ID"
		resultType="com.project.movieadmin.story.StoryVO">
		
	</select>

	
	<select id="SEARCHLIST_NAME"
		resultType="com.project.movieadmin.story.StoryVO">
		
	</select>

	<select id="SEARCHLIST_PAGE_BLOCK_ID"
		resultType="com.project.movieadmin.story.StoryVO">
		
	</select>

	<select id="SEARCHLIST_PAGE_BLOCK_NAME"
		resultType="com.project.movieadmin.story.StoryVO">
		
	</select>


	<select id="TOTAL_ROWS"	resultType="int">
		
	</select>

	
	<select id="SEARCH_TOTAL_ROWS_ID"	resultType="int">
	
	</select>

	
	<select id="SEARCH_TOTAL_ROWS_NAME"	resultType="int">
		
	</select>

	
	<select id="LOGIN"	resultType="com.project.movieadmin.story.StoryVO">
		
	</select>


</mapper>